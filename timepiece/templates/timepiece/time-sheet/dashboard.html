{% extends "timepiece/time-sheet/base.html" %}
{% load url from future %}

{% block title %}Timepiece Dashboard{% endblock title %}

{% block bodyid %}dashboard{% endblock bodyid %}

{% block extrajs %}
    <script src="{{ STATIC_URL }}d3/d3.v2.min.js"></script>
{% endblock extrajs %}

{% block breadcrumb %}
{% endblock breadcrumb %}

{% block content %}
    {% if perms.timepiece.can_clock_in %}
        <h2>{{ from_date|date:'F j' }} to {{ to_date|date:'F j' }}</h2>

        <div class="row-fluid">
            <div class="span12" id="active-entry">
                <div id="active-header">
                    <h3>Current Entry</h3>
                    <div>
                        <a class="btn btn-primary" href="{% url 'timepiece-clock-in' %}">Clock In</a>
                        {% if active_entry %}
                            <a class="btn btn-primary" href="{% url 'timepiece-clock-out' active_entry.pk %}">Clock Out</a>
                            <a class="btn btn-{% if active_entry.is_paused %}inverse{% else %}primary{% endif %}"
                                    href="{% url 'timepiece-toggle-paused' active_entry.pk %}">
                                {% if active_entry.is_paused %}Resume{% else %}Pause{% endif %}
                            </a>
                            <a class="btn btn-primary" href="{% url 'timepiece-update' active_entry.pk %}">Edit</a>
                        {% endif %}
                    </div>
                </div>

                <p>
                    {% if active_entry %}
                        You have been clocked into
                        <a href="{% url 'view_project' active_entry.project.pk %}">{{ active_entry.project.name }}</a>
                        since {{ active_entry.start_time|date:"g:i A" }}{% if not active_today %} on
                        {{ active_entry.start_time|date:"l, F j" }}{% endif %}.
                    {% else %}
                        You are not currently clocked in to a project.
                    {% endif %}
                </p>
            </div>
        </div>

        <ul class="nav nav-tabs">
            <li class="active"><a href="#progress" data-toggle="tab">Progress</a></li>
            <li><a href="#entries" data-toggle="tab">Entries</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="progress">
                <div id="week-hours" data="{{ weeks_entries_json }}"></div>
                <script src="{{ STATIC_URL }}timepiece/js/dashboard/week.js"></script>
            </div>
            <div class="tab-pane" id="entries">
                <a class="btn add-entry" href="{% url 'timepiece-add' %}">Add Entry</a>
                <table class="table table-striped table-condensed table-bordered" style="margin-top:10px;">
                    <thead>
                        <th>Date</th>
                        <th>Entry</th>
                        <th>Clock In</th>
                        <th>Clock Out</th>
                        <th>Pause Time</th>
                        <th>Total Time</th>
                        <th>Actions</th>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    {% endif %}
{% endblock content %}
